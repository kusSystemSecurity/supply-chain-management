"""
Vulnerability-related Pydantic schemas
"""

from typing import Optional, Dict, Any
from pydantic import BaseModel


class VulnerabilityBase(BaseModel):
    """Base vulnerability schema"""
    cve_id: str
    package_name: Optional[str] = None
    package_version: Optional[str] = None
    severity: str = "UNKNOWN"
    cvss_score: Optional[float] = None
    epss_score: Optional[float] = None
    epss_percentile: Optional[float] = None
    epss_date: Optional[str] = None


class Vulnerability(VulnerabilityBase):
    """Schema for vulnerability response"""
    id: str
    scan_id: str
    epss_predicted: bool = False
    cve_details: Optional[Dict[str, Any]] = None
    cve_api_details: Optional[Dict[str, Any]] = None

    class Config:
        from_attributes = True


class VulnerabilityDetail(Vulnerability):
    """Schema for detailed vulnerability response"""
    pass


class VulnerabilityListResponse(BaseModel):
    """Schema for vulnerability list response"""
    vulnerabilities: list[Vulnerability]
    total: int
    scan_id: str

